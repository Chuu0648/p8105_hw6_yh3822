---
title: "p8105_hw6_yh3822"
output: github_document
date: "2024-12-01"
---

```{r set up}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(tidyverse)
library(dplyr)
library(broom)
library(p8105.datasets)

set.seed(1)
```



```{r, warning=FALSE, message=FALSE}
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2017-01-01",
    date_max = "2017-12-31") %>%
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY"),
    tmin = tmin / 10,
    tmax = tmax / 10) %>%
  select(name, id, everything())
```



## Problem 1


```{r}
bootstrap_analysis = function(data) {
  model = lm(tmax ~ tmin, data = data)
  r_squared = glance(model)$r.squared
  coefs = tidy(model)
  log_beta0_beta1 = log(coefs$estimate[1] * coefs$estimate[2])
  
  tibble(
    r_squared = r_squared,
    log_beta0_beta1 = log_beta0_beta1
  )
}
```



```{r}
bootstrap_results = weather_df |>
  modelr::bootstrap(n = 5000) |> 
  mutate(results = map(strap, ~ bootstrap_analysis(as_tibble(.)))) |> 
  select(results) |> 
  unnest(results)
```



```{r}
bootstrap_results %>%
  ggplot(aes(x = r_squared)) +
  geom_density(fill = "blue", alpha = 0.5) +
  labs(title = "Distribution of R-squared", x = "R-squared", y = "Density")
```

This plot shows that the model consistently explains a high proportion of the variance in values primarily ranging between 0.88 and 0.94, and the density plot of r_squared is approximately symmetric.



```{r}
bootstrap_results %>%
  ggplot(aes(x = log_beta0_beta1)) +
  geom_density(fill = "green", alpha = 0.5) +
  labs(title = "Distribution of log(beta0 * beta1)", x = "log(beta0 * beta1)", y = "Density")
```


The distribution is symmetric, indicating consistent estimates across bootstrap samples and minimal variability in log(beta0*beta1). It suggests a stable relationship between tmax and tmin.







